<html>
<head>
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<script src="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js"></script>
</head>
<body>
	<form>
		Term: <input type="text" id="term">
		Subject: <input type="text" id="subject" placeholder="Input your subject...">
	</form>
<!--
	<ul data-role="listview" data-filter="true" data-filter-reveal="true" data-input="#subject" data-inset="true" data-autodividers="true" id="subject_list"></ul>
-->
	<form>
		Search: <input type="text" id="search">
	</form>
	<button onclick = getCourses()>submit</button>

	<div id="course_list"></div>

</body>

<script>

$(document).ready(function(){
	$("#subject_list").html("<ul data-role="listview" data-filter="true" data-filter-reveal="true" data-input="#subject" data-inset="true" data-autodividers="true" id="subject_list">
		<li>EECS</li>
		<li>Economics</li>
		<li>Chemistry<li>
		<li>Math</li>
		</ul>")
});

function searchCourses(data, search, callback) {
	var course_list=[]
	console.log(data[1])
	var i
	for(i=0; i<data.length; i++){
		if( data[i]['title'].search(new RegExp(search, "i")) != -1 ){
			console.log(data[i]['title'])
			course_list.push(data[i]);
		}
	}
	if(course_list.length === 0) {
		alert("no courses found")
	} else {
		console.log(course_list)
		callback(course_list)
	}
}

function showCourses(course_list){
	$("#course_list").html('')
	console.log(course_list[0])
	var i;
	for(i =0; i<course_list.length; i++){
		$("#course_list").append("<li>"+ course_list[i]['title'] +"</li>")
	}
}

function getCourses() {
	var course_list;

	var term = $("#term").val();
	console.log(term)
	var subject = $("#subject").val();
	console.log(subject)
	var search = $("#search").val();

	var url = "http://vazzak2.ci.northwestern.edu/courses/?term=" + term + "&subject=" + subject;
	console.log(url);
	$.ajax({
		type: 'GET',
 		url: url,
 		datatype: 'jsonp',
 		async: false,
 		success: function(data) {
 			searchCourses(data, search, showCourses)
 		},
 		error: function(errorData) {
 			alert("Error getting data!")
 		}
	});
}

</script>
</html>